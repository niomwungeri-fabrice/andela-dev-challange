'use strict';var cov_2lbopy1zr6=function(){var path="/home/inyenyeri/Downloads/JavaScript/andela-dev-challange/src/controller/Parcel-controller.js",hash="86925624d9f56ac82855a93761d0738ad3991b01",Function=function(){}.constructor,global=new Function('return this')(),gcv="__coverage__",coverageData={path:"/home/inyenyeri/Downloads/JavaScript/andela-dev-challange/src/controller/Parcel-controller.js",statementMap:{"0":{start:{line:3,column:0},end:{line:5,column:3}},"1":{start:{line:7,column:14},end:{line:7,column:31}},"2":{start:{line:9,column:15},end:{line:9,column:46}},"3":{start:{line:11,column:9},end:{line:11,column:27}},"4":{start:{line:13,column:10},end:{line:13,column:36}},"5":{start:{line:15,column:10},end:{line:15,column:26}},"6":{start:{line:17,column:11},end:{line:17,column:38}},"7":{start:{line:19,column:14},end:{line:19,column:40}},"8":{start:{line:21,column:15},end:{line:21,column:46}},"9":{start:{line:23,column:39},end:{line:23,column:93}},"10":{start:{line:26,column:14},end:{line:131,column:1}},"11":{start:{line:29,column:20},end:{line:29,column:28}},"12":{start:{line:30,column:19},end:{line:30,column:37}},"13":{start:{line:31,column:22},end:{line:31,column:43}},"14":{start:{line:32,column:17},end:{line:32,column:33}},"15":{start:{line:33,column:16},end:{line:33,column:31}},"16":{start:{line:34,column:17},end:{line:34,column:33}},"17":{start:{line:35,column:18},end:{line:35,column:35}},"18":{start:{line:36,column:17},end:{line:36,column:33}},"19":{start:{line:39,column:20},end:{line:39,column:193}},"20":{start:{line:40,column:22},end:{line:40,column:221}},"21":{start:{line:41,column:4},end:{line:48,column:5}},"22":{start:{line:42,column:17},end:{line:42,column:80}},"23":{start:{line:43,column:17},end:{line:43,column:26}},"24":{start:{line:45,column:6},end:{line:45,column:43}},"25":{start:{line:47,column:6},end:{line:47,column:41}},"26":{start:{line:53,column:23},end:{line:53,column:46}},"27":{start:{line:54,column:4},end:{line:62,column:5}},"28":{start:{line:55,column:18},end:{line:55,column:56}},"29":{start:{line:56,column:17},end:{line:56,column:27}},"30":{start:{line:57,column:21},end:{line:57,column:35}},"31":{start:{line:59,column:6},end:{line:59,column:70}},"32":{start:{line:61,column:6},end:{line:61,column:41}},"33":{start:{line:67,column:28},end:{line:67,column:71}},"34":{start:{line:68,column:4},end:{line:76,column:5}},"35":{start:{line:69,column:18},end:{line:69,column:82}},"36":{start:{line:70,column:17},end:{line:70,column:27}},"37":{start:{line:71,column:21},end:{line:71,column:35}},"38":{start:{line:73,column:6},end:{line:73,column:70}},"39":{start:{line:75,column:6},end:{line:75,column:41}},"40":{start:{line:81,column:15},end:{line:81,column:52}},"41":{start:{line:82,column:4},end:{line:92,column:5}},"42":{start:{line:83,column:18},end:{line:83,column:71}},"43":{start:{line:84,column:17},end:{line:84,column:27}},"44":{start:{line:86,column:6},end:{line:88,column:7}},"45":{start:{line:87,column:8},end:{line:87,column:70}},"46":{start:{line:89,column:6},end:{line:89,column:43}},"47":{start:{line:91,column:6},end:{line:91,column:41}},"48":{start:{line:97,column:23},end:{line:97,column:60}},"49":{start:{line:98,column:25},end:{line:98,column:110}},"50":{start:{line:99,column:4},end:{line:112,column:5}},"51":{start:{line:100,column:18},end:{line:100,column:79}},"52":{start:{line:101,column:17},end:{line:101,column:27}},"53":{start:{line:103,column:6},end:{line:105,column:7}},"54":{start:{line:104,column:8},end:{line:104,column:69}},"55":{start:{line:106,column:22},end:{line:106,column:230}},"56":{start:{line:107,column:25},end:{line:107,column:84}},"57":{start:{line:108,column:21},end:{line:108,column:75}},"58":{start:{line:109,column:6},end:{line:109,column:52}},"59":{start:{line:111,column:6},end:{line:111,column:39}},"60":{start:{line:117,column:4},end:{line:117,column:64}},"61":{start:{line:123,column:4},end:{line:123,column:60}},"62":{start:{line:129,column:4},end:{line:129,column:52}},"63":{start:{line:133,column:0},end:{line:133,column:26}}},fnMap:{"0":{name:"_interopRequireDefault",decl:{start:{line:23,column:9},end:{line:23,column:31}},loc:{start:{line:23,column:37},end:{line:23,column:95}},line:23},"1":{name:"create",decl:{start:{line:28,column:25},end:{line:28,column:31}},loc:{start:{line:28,column:42},end:{line:49,column:3}},line:28},"2":{name:"getAll",decl:{start:{line:52,column:25},end:{line:52,column:31}},loc:{start:{line:52,column:42},end:{line:63,column:3}},line:52},"3":{name:"parcelByUser",decl:{start:{line:66,column:31},end:{line:66,column:43}},loc:{start:{line:66,column:54},end:{line:77,column:3}},line:66},"4":{name:"getOne",decl:{start:{line:80,column:25},end:{line:80,column:31}},loc:{start:{line:80,column:42},end:{line:93,column:3}},line:80},"5":{name:"cancel",decl:{start:{line:96,column:25},end:{line:96,column:31}},loc:{start:{line:96,column:42},end:{line:113,column:3}},line:96},"6":{name:"presentLocation",decl:{start:{line:116,column:34},end:{line:116,column:49}},loc:{start:{line:116,column:60},end:{line:118,column:3}},line:116},"7":{name:"destination",decl:{start:{line:122,column:30},end:{line:122,column:41}},loc:{start:{line:122,column:52},end:{line:124,column:3}},line:122},"8":{name:"status",decl:{start:{line:128,column:25},end:{line:128,column:31}},loc:{start:{line:128,column:42},end:{line:130,column:3}},line:128}},branchMap:{"0":{loc:{start:{line:23,column:46},end:{line:23,column:92}},type:"cond-expr",locations:[{start:{line:23,column:70},end:{line:23,column:73}},{start:{line:23,column:76},end:{line:23,column:92}}],line:23},"1":{loc:{start:{line:23,column:46},end:{line:23,column:67}},type:"binary-expr",locations:[{start:{line:23,column:46},end:{line:23,column:49}},{start:{line:23,column:53},end:{line:23,column:67}}],line:23},"2":{loc:{start:{line:86,column:6},end:{line:88,column:7}},type:"if",locations:[{start:{line:86,column:6},end:{line:88,column:7}},{start:{line:86,column:6},end:{line:88,column:7}}],line:86},"3":{loc:{start:{line:103,column:6},end:{line:105,column:7}},type:"if",locations:[{start:{line:103,column:6},end:{line:105,column:7}},{start:{line:103,column:6},end:{line:105,column:7}}],line:103}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0]},_coverageSchema:"43e27e138ebf9cfc5966b082cf9a028302ed4184"},coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();cov_2lbopy1zr6.s[0]++;Object.defineProperty(exports,"__esModule",{value:true});var _moment=(cov_2lbopy1zr6.s[1]++,require('moment'));var _moment2=(cov_2lbopy1zr6.s[2]++,_interopRequireDefault(_moment));var _v=(cov_2lbopy1zr6.s[3]++,require('uuid/v4'));var _v2=(cov_2lbopy1zr6.s[4]++,_interopRequireDefault(_v));var _db=(cov_2lbopy1zr6.s[5]++,require('../db'));var _db2=(cov_2lbopy1zr6.s[6]++,_interopRequireDefault(_db));var _parcel=(cov_2lbopy1zr6.s[7]++,require('../model/parcel'));var _parcel2=(cov_2lbopy1zr6.s[8]++,_interopRequireDefault(_parcel));function _interopRequireDefault(obj){cov_2lbopy1zr6.f[0]++;cov_2lbopy1zr6.s[9]++;return(cov_2lbopy1zr6.b[1][0]++,obj)&&(cov_2lbopy1zr6.b[1][1]++,obj.__esModule)?(cov_2lbopy1zr6.b[0][0]++,obj):(cov_2lbopy1zr6.b[0][1]++,{default:obj});}/* Code modified from a file obtained from https://github.com/olawalejarvis/reflection_app_server */var Parcels=(cov_2lbopy1zr6.s[10]++,{// Create a parcel delivery order
create:async function create(req,res){cov_2lbopy1zr6.f[1]++;var _req$body=(cov_2lbopy1zr6.s[11]++,req.body),location=(cov_2lbopy1zr6.s[12]++,_req$body.location),destination=(cov_2lbopy1zr6.s[13]++,_req$body.destination),length=(cov_2lbopy1zr6.s[14]++,_req$body.length),width=(cov_2lbopy1zr6.s[15]++,_req$body.width),height=(cov_2lbopy1zr6.s[16]++,_req$body.height),ownerId=(cov_2lbopy1zr6.s[17]++,_req$body.ownerId),status=(cov_2lbopy1zr6.s[18]++,_req$body.status);var newParcel=(cov_2lbopy1zr6.s[19]++,new _parcel2.default((0,_v2.default)(),location,destination,length,width,height,ownerId,status,(0,_moment2.default)(new Date()),(0,_moment2.default)(new Date())));var createQuery=(cov_2lbopy1zr6.s[20]++,'INSERT INTO\n      parcels(id, location, destination, length, width, height, owner_id, status, created_date, modified_date)\n      VALUES($1, $2, $3, $4, $5, $6, $7, $8, $9, $10)\n      returning *');cov_2lbopy1zr6.s[21]++;try{var _ref=(cov_2lbopy1zr6.s[22]++,await _db2.default.query(createQuery,Object.values(newParcel))),rows=(cov_2lbopy1zr6.s[23]++,_ref.rows);cov_2lbopy1zr6.s[24]++;return res.status(201).send(rows[0]);}catch(error){cov_2lbopy1zr6.s[25]++;return res.status(400).send(error);}},// Fetch all parcel delivery orders
getAll:async function getAll(req,res){cov_2lbopy1zr6.f[2]++;var findAllQuery=(cov_2lbopy1zr6.s[26]++,'SELECT * FROM parcels');cov_2lbopy1zr6.s[27]++;try{var _ref2=(cov_2lbopy1zr6.s[28]++,await _db2.default.query(findAllQuery)),rows=(cov_2lbopy1zr6.s[29]++,_ref2.rows),rowCount=(cov_2lbopy1zr6.s[30]++,_ref2.rowCount);cov_2lbopy1zr6.s[31]++;return res.status(200).send({rows:rows,rowCount:rowCount});}catch(error){cov_2lbopy1zr6.s[32]++;return res.status(400).send(error);}},// Fetch all parcel delivery orders by a specific user
parcelByUser:async function parcelByUser(req,res){cov_2lbopy1zr6.f[3]++;var parcelByUserQuery=(cov_2lbopy1zr6.s[33]++,'SELECT * FROM parcels where owner_id = $1');cov_2lbopy1zr6.s[34]++;try{var _ref3=(cov_2lbopy1zr6.s[35]++,await _db2.default.query(parcelByUserQuery,[req.params.userId])),rows=(cov_2lbopy1zr6.s[36]++,_ref3.rows),rowCount=(cov_2lbopy1zr6.s[37]++,_ref3.rowCount);cov_2lbopy1zr6.s[38]++;return res.status(200).send({rows:rows,rowCount:rowCount});}catch(error){cov_2lbopy1zr6.s[39]++;return res.status(400).send(error);}},// Fetch a specific parcel delivery order
getOne:async function getOne(req,res){cov_2lbopy1zr6.f[4]++;var text=(cov_2lbopy1zr6.s[40]++,'SELECT * FROM parcels WHERE id = $1');cov_2lbopy1zr6.s[41]++;try{var _ref4=(cov_2lbopy1zr6.s[42]++,await _db2.default.query(text,[req.params.parcelId])),rows=(cov_2lbopy1zr6.s[43]++,_ref4.rows);cov_2lbopy1zr6.s[44]++;if(!rows[0]){cov_2lbopy1zr6.b[2][0]++;cov_2lbopy1zr6.s[45]++;return res.status(404).send({message:'parcels not found'});}else{cov_2lbopy1zr6.b[2][1]++;}cov_2lbopy1zr6.s[46]++;return res.status(200).send(rows[0]);}catch(error){cov_2lbopy1zr6.s[47]++;return res.status(400).send(error);}},// Cancel the specific parcel delivery order
cancel:async function cancel(req,res){cov_2lbopy1zr6.f[5]++;var findOneQuery=(cov_2lbopy1zr6.s[48]++,'SELECT * FROM parcels WHERE id = $1');var updateOneQuery=(cov_2lbopy1zr6.s[49]++,'UPDATE parcels\n      SET status=$1,modified_date=$2\n      WHERE id=$3 returning *');cov_2lbopy1zr6.s[50]++;try{var _ref5=(cov_2lbopy1zr6.s[51]++,await _db2.default.query(findOneQuery,[req.params.parcelId])),rows=(cov_2lbopy1zr6.s[52]++,_ref5.rows);cov_2lbopy1zr6.s[53]++;if(!rows[0]){cov_2lbopy1zr6.b[3][0]++;cov_2lbopy1zr6.s[54]++;return res.status(404).send({message:'parcel not found'});}else{cov_2lbopy1zr6.b[3][1]++;}var newParcel=(cov_2lbopy1zr6.s[55]++,new _parcel2.default(rows[0].id,rows[0].location,rows[0].destination,rows[0].length,rows[0].width,rows[0].height,rows[0].ownerId,rows[0].status,rows[0].created_date,(0,_moment2.default)(new Date())));var updateValues=(cov_2lbopy1zr6.s[56]++,['Canceled',(0,_moment2.default)(new Date()),rows[0].id]);var response=(cov_2lbopy1zr6.s[57]++,await _db2.default.query(updateOneQuery,updateValues));cov_2lbopy1zr6.s[58]++;return res.status(200).send(response.rows[0]);}catch(err){cov_2lbopy1zr6.s[59]++;return res.status(400).send(err);}},// Change the present location of a specific parcel delivery order
presentLocation:async function presentLocation(req,res){cov_2lbopy1zr6.f[6]++;cov_2lbopy1zr6.s[60]++;return res.status(200).send({message:'presentLocation'});},// Change the location ofa specific parcel delivery order -
// only for the user who created it
destination:async function destination(req,res){cov_2lbopy1zr6.f[7]++;cov_2lbopy1zr6.s[61]++;return res.status(200).send({message:'destination'});},// Change the status of a specific parcel delivery order -
// This endpoint should be accessible by the Admin only
status:async function status(req,res){cov_2lbopy1zr6.f[8]++;cov_2lbopy1zr6.s[62]++;return res.status().send({message:'status'});}});cov_2lbopy1zr6.s[63]++;exports.default=Parcels;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlBhcmNlbC1jb250cm9sbGVyLmpzIl0sIm5hbWVzIjpbIlBhcmNlbHMiLCJjcmVhdGUiLCJyZXEiLCJyZXMiLCJib2R5IiwibG9jYXRpb24iLCJkZXN0aW5hdGlvbiIsImxlbmd0aCIsIndpZHRoIiwiaGVpZ2h0Iiwib3duZXJJZCIsInN0YXR1cyIsIm5ld1BhcmNlbCIsIlBhcmNlbCIsIkRhdGUiLCJjcmVhdGVRdWVyeSIsImRiIiwicXVlcnkiLCJPYmplY3QiLCJ2YWx1ZXMiLCJyb3dzIiwic2VuZCIsImVycm9yIiwiZ2V0QWxsIiwiZmluZEFsbFF1ZXJ5Iiwicm93Q291bnQiLCJwYXJjZWxCeVVzZXIiLCJwYXJjZWxCeVVzZXJRdWVyeSIsInBhcmFtcyIsInVzZXJJZCIsImdldE9uZSIsInRleHQiLCJwYXJjZWxJZCIsIm1lc3NhZ2UiLCJjYW5jZWwiLCJmaW5kT25lUXVlcnkiLCJ1cGRhdGVPbmVRdWVyeSIsImlkIiwiY3JlYXRlZF9kYXRlIiwidXBkYXRlVmFsdWVzIiwicmVzcG9uc2UiLCJlcnIiLCJwcmVzZW50TG9jYXRpb24iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUNBOzs7O0FBQ0E7Ozs7QUFDQTs7OztBQUNBOzs7Ozs7QUFKQTtBQU1BLElBQU1BLFVBQVU7QUFDZDtBQUNNQyxRQUZRLHdCQUVEQyxHQUZDLEVBRUlDLEdBRkosRUFFUztBQUFBLG9CQUdqQkQsSUFBSUUsSUFIYTtBQUFBLFFBRW5CQyxRQUZtQixhQUVuQkEsUUFGbUI7QUFBQSxRQUVUQyxXQUZTLGFBRVRBLFdBRlM7QUFBQSxRQUVJQyxNQUZKLGFBRUlBLE1BRko7QUFBQSxRQUVZQyxLQUZaLGFBRVlBLEtBRlo7QUFBQSxRQUVtQkMsTUFGbkIsYUFFbUJBLE1BRm5CO0FBQUEsUUFFMkJDLE9BRjNCLGFBRTJCQSxPQUYzQjtBQUFBLFFBRW9DQyxNQUZwQyxhQUVvQ0EsTUFGcEM7OztBQUtyQixRQUFNQyxZQUFZLElBQUlDLGdCQUFKLENBQVcsa0JBQVgsRUFBcUJSLFFBQXJCLEVB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QXJCLENBQVA7QUFDRCxLQWZELENBZUUsT0FBT3FCLEdBQVAsRUFBWTtBQUNaLGFBQU90QyxJQUFJUSxNQUFKLENBQVcsR0FBWCxFQUFnQlUsSUFBaEIsQ0FBcUJvQixHQUFyQixDQUFQO0FBQ0Q7QUFDRixHQTdFYTs7QUE4RWQ7QUFDTUMsaUJBL0VRLGlDQStFUXhDLEdBL0VSLEVBK0VhQyxHQS9FYixFQStFa0I7QUFDOUIsV0FBT0EsSUFBSVEsTUFBSixDQUFXLEdBQVgsRUFBZ0JVLElBQWhCLENBQXFCLEVBQUVZLFNBQVMsaUJBQVgsRUFBckIsQ0FBUDtBQUNELEdBakZhOztBQWtGZDtBQUNBO0FBQ00zQixhQXBGUSw2QkFvRklKLEdBcEZKLEVBb0ZTQyxHQXBGVCxFQW9GYztBQUMxQixXQUFPQSxJQUFJUSxNQUFKLENBQVcsR0FBWCxFQUFnQlUsSUFBaEIsQ0FBcUIsRUFBRVksU0FBUyxhQUFYLEVBQXJCLENBQVA7QUFDRCxHQXRGYTs7QUF1RmQ7QUFDQTtBQUNNdEIsUUF6RlEsd0JBeUZEVCxHQXpGQyxFQXlGSUMsR0F6RkosRUF5RlM7QUFDckIsV0FBT0EsSUFBSVEsTUFBSixHQUFhVSxJQUFiLENBQWtCLEVBQUVZLFNBQVMsUUFBWCxFQUFsQixDQUFQO0FBQ0Q7QUEzRmEsQ0FBaEI7O2tCQThGZWpDLE8iLCJmaWxlIjoiUGFyY2VsLWNvbnRyb2xsZXIuanMiLCJzb3VyY2VSb290IjoiL2hvbWUvaW55ZW55ZXJpL0Rvd25sb2Fkcy9KYXZhU2NyaXB0L2FuZGVsYS1kZXYtY2hhbGxhbmdlL3NyYy9jb250cm9sbGVyIiwic291cmNlc0NvbnRlbnQiOlsiLyogQ29kZSBtb2RpZmllZCBmcm9tIGEgZmlsZSBvYnRhaW5lZCBmcm9tIGh0dHBzOi8vZ2l0aHViLmNvbS9vbGF3YWxlamFydmlzL3JlZmxlY3Rpb25fYXBwX3NlcnZlciAqL1xuaW1wb3J0IG1vbWVudCBmcm9tICdtb21lbnQnO1xuaW1wb3J0IHV1aWR2NCBmcm9tICd1dWlkL3Y0JztcbmltcG9ydCBkYiBmcm9tICcuLi9kYic7XG5pbXBvcnQgUGFyY2VsIGZyb20gJy4uL21vZGVsL3BhcmNlbCc7XG5cbmNvbnN0IFBhcmNlbHMgPSB7XG4gIC8vIENyZWF0ZSBhIHBhcmNlbCBkZWxpdmVyeSBvcmRlclxuICBhc3luYyBjcmVhdGUocmVxLCByZXMpIHtcbiAgICBjb25zdCB7XG4gICAgICBsb2NhdGlvbiwgZGVzdGluYXRpb24sIGxlbmd0aCwgd2lkdGgsIGhlaWdodCwgb3duZXJJZCwgc3RhdHVzLFxuICAgIH0gPSByZXEuYm9keTtcblxuICAgIGNvbnN0IG5ld1BhcmNlbCA9IG5ldyBQYXJjZWwodXVpZHY0KCksIGxvY2F0aW9uLCBkZXN0aW5hdGlvbiwgbGVuZ3RoLCB3aWR0aCwgaGVpZ2h0LFxuICAgICAgb3duZXJJZCwgc3RhdHVzLCBtb21lbnQobmV3IERhdGUoKSksIG1vbWVudChuZXcgRGF0ZSgpKSk7XG4gICAgY29uc3QgY3JlYXRlUXVlcnkgPSBgSU5TRVJUIElOVE9cbiAgICAgIHBhcmNlbHMoaWQsIGxvY2F0aW9uLCBkZXN0aW5hdGlvbiwgbGVuZ3RoLCB3aWR0aCwgaGVpZ2h0LCBvd25lcl9pZCwgc3RhdHVzLCBjcmVhdGVkX2RhdGUsIG1vZGlmaWVkX2RhdGUpXG4gICAgICBWQUxVRVMoJDEsICQyLCAkMywgJDQsICQ1LCAkNiwgJDcsICQ4LCAkOSwgJDEwKVxuICAgICAgcmV0dXJuaW5nICpgO1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB7IHJvd3MgfSA9IGF3YWl0IGRiLnF1ZXJ5KGNyZWF0ZVF1ZXJ5LCBPYmplY3QudmFsdWVzKG5ld1BhcmNlbCkpO1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAxKS5zZW5kKHJvd3NbMF0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLnNlbmQoZXJyb3IpO1xuICAgIH1cbiAgfSxcbiAgLy8gRmV0Y2ggYWxsIHBhcmNlbCBkZWxpdmVyeSBvcmRlcnNcbiAgYXN5bmMgZ2V0QWxsKHJlcSwgcmVzKSB7XG4gICAgY29uc3QgZmluZEFsbFF1ZXJ5ID0gJ1NFTEVDVCAqIEZST00gcGFyY2Vscyc7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHsgcm93cywgcm93Q291bnQgfSA9IGF3YWl0IGRiLnF1ZXJ5KGZpbmRBbGxRdWVyeSk7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cygyMDApLnNlbmQoeyByb3dzLCByb3dDb3VudCB9KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5zZW5kKGVycm9yKTtcbiAgICB9XG4gIH0sXG4gIC8vIEZldGNoIGFsbCBwYXJjZWwgZGVsaXZlcnkgb3JkZXJzIGJ5IGEgc3BlY2lmaWMgdXNlclxuICBhc3luYyBwYXJjZWxCeVVzZXIocmVxLCByZXMpIHtcbiAgICBjb25zdCBwYXJjZWxCeVVzZXJRdWVyeSA9ICdTRUxFQ1QgKiBGUk9NIHBhcmNlbHMgd2hlcmUgb3duZXJfaWQgPSAkMSc7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHsgcm93cywgcm93Q291bnQgfSA9IGF3YWl0IGRiLnF1ZXJ5KHBhcmNlbEJ5VXNlclF1ZXJ5LCBbcmVxLnBhcmFtcy51c2VySWRdKTtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuc2VuZCh7IHJvd3MsIHJvd0NvdW50IH0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLnNlbmQoZXJyb3IpO1xuICAgIH1cbiAgfSxcbiAgLy8gRmV0Y2ggYSBzcGVjaWZpYyBwYXJjZWwgZGVsaXZlcnkgb3JkZXJcbiAgYXN5bmMgZ2V0T25lKHJlcSwgcmVzKSB7XG4gICAgY29uc3QgdGV4dCA9ICdTRUxFQ1QgKiBGUk9NIHBhcmNlbHMgV0hFUkUgaWQgPSAkMSc7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHsgcm93cyB9ID0gYXdhaXQgZGIucXVlcnkodGV4dCwgW3JlcS5wYXJhbXMucGFyY2VsSWRdKTtcbiAgICAgIGlmICghcm93c1swXSkge1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLnNlbmQoeyBtZXNzYWdlOiAncGFyY2VscyBub3QgZm91bmQnIH0pO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5zZW5kKHJvd3NbMF0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLnNlbmQoZXJyb3IpO1xuICAgIH1cbiAgfSxcbiAgLy8gQ2FuY2VsIHRoZSBzcGVjaWZpYyBwYXJjZWwgZGVsaXZlcnkgb3JkZXJcbiAgYXN5bmMgY2FuY2VsKHJlcSwgcmVzKSB7XG4gICAgY29uc3QgZmluZE9uZVF1ZXJ5ID0gJ1NFTEVDVCAqIEZST00gcGFyY2VscyBXSEVSRSBpZCA9ICQxJztcbiAgICBjb25zdCB1cGRhdGVPbmVRdWVyeSA9IGBVUERBVEUgcGFyY2Vsc1xuICAgICAgU0VUIHN0YXR1cz0kMSxtb2RpZmllZF9kYXRlPSQyXG4gICAgICBXSEVSRSBpZD0kMyByZXR1cm5pbmcgKmA7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHsgcm93cyB9ID0gYXdhaXQgZGIucXVlcnkoZmluZE9uZVF1ZXJ5LCBbcmVxLnBhcmFtcy5wYXJjZWxJZF0pO1xuICAgICAgaWYgKCFyb3dzWzBdKSB7XG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuc2VuZCh7IG1lc3NhZ2U6ICdwYXJjZWwgbm90IGZvdW5kJyB9KTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IG5ld1BhcmNlbCA9IG5ldyBQYXJjZWwocm93c1swXS5pZCwgcm93c1swXS5sb2NhdGlvbiwgcm93c1swXS5kZXN0aW5hdGlvbixcbiAgICAgICAgcm93c1swXS5sZW5ndGgsIHJvd3NbMF0ud2lkdGgsIHJvd3NbMF0uaGVpZ2h0LCByb3dzWzBdLm93bmVySWQsIHJvd3NbMF0uc3RhdHVzLFxuICAgICAgICByb3dzWzBdLmNyZWF0ZWRfZGF0ZSwgbW9tZW50KG5ldyBEYXRlKCkpKTtcbiAgICAgIGNvbnN0IHVwZGF0ZVZhbHVlcyA9IFtcbiAgICAgICAgJ0NhbmNlbGVkJyxcbiAgICAgICAgbW9tZW50KG5ldyBEYXRlKCkpLFxuICAgICAgICByb3dzWzBdLmlkLFxuICAgICAgXTtcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZGIucXVlcnkodXBkYXRlT25lUXVlcnksIHVwZGF0ZVZhbHVlcyk7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cygyMDApLnNlbmQocmVzcG9uc2Uucm93c1swXSk7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLnNlbmQoZXJyKTtcbiAgICB9XG4gIH0sXG4gIC8vIENoYW5nZSB0aGUgcHJlc2VudCBsb2NhdGlvbiBvZiBhIHNwZWNpZmljIHBhcmNlbCBkZWxpdmVyeSBvcmRlclxuICBhc3luYyBwcmVzZW50TG9jYXRpb24ocmVxLCByZXMpIHtcbiAgICByZXR1cm4gcmVzLnN0YXR1cygyMDApLnNlbmQoeyBtZXNzYWdlOiAncHJlc2VudExvY2F0aW9uJyB9KTtcbiAgfSxcbiAgLy8gQ2hhbmdlIHRoZSBsb2NhdGlvbiBvZmEgc3BlY2lmaWMgcGFyY2VsIGRlbGl2ZXJ5IG9yZGVyIC1cbiAgLy8gb25seSBmb3IgdGhlIHVzZXIgd2hvIGNyZWF0ZWQgaXRcbiAgYXN5bmMgZGVzdGluYXRpb24ocmVxLCByZXMpIHtcbiAgICByZXR1cm4gcmVzLnN0YXR1cygyMDApLnNlbmQoeyBtZXNzYWdlOiAnZGVzdGluYXRpb24nIH0pO1xuICB9LFxuICAvLyBDaGFuZ2UgdGhlIHN0YXR1cyBvZiBhIHNwZWNpZmljIHBhcmNlbCBkZWxpdmVyeSBvcmRlciAtXG4gIC8vIFRoaXMgZW5kcG9pbnQgc2hvdWxkIGJlIGFjY2Vzc2libGUgYnkgdGhlIEFkbWluIG9ubHlcbiAgYXN5bmMgc3RhdHVzKHJlcSwgcmVzKSB7XG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoKS5zZW5kKHsgbWVzc2FnZTogJ3N0YXR1cycgfSk7XG4gIH0sXG59O1xuXG5leHBvcnQgZGVmYXVsdCBQYXJjZWxzO1xuIl19